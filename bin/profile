#!/bin/bash --
. ~/.bashrc
alias ls='ls --color'
alias vim74='/Applications/MacVim.app/Contents/MacOS/Vim'
alias iterm='/Applications/iTerm.app/Contents/MacOS/iTerm'
alias finder='~/bin/finder.sh'
alias eclipse="/home/wwallace/EclipseMarsforOmniStack/eclipse &"
alias eclipse2019="/home/wwallace/EclipseIDE_2019-12/eclipse/eclipse &"
export EDITOR="vim"
export GIT_EDITOR="vim"
export JAVA_HOME="/usr/lib/jvm/java-8-openjdk-amd64"
export MVN_BIN="/Users/willwallace/apache-maven-3.3.9/bin"
export GOROOT="/usr/local/go"
export GO_BIN="${GOROOT}/bin"
export GOPATH="$HOME/go"
export SANDBOX="${HOME}/sandbox"
export SSH_USER="wwallace"
export BUGS=/media/wwallace/shared/BUGS
export SVA_TOOLS=${HOME}/SVA/tools
export ROBOT_ROOT="/home/wwallace/sandbox/robot"
#export GIT_SSL_NO_VERIFY=1

alias ssvtsetup='cd ${SANDBOX}/svt-dev-tools && source bin/svtsetup'
alias ovftool='/Applications/VMware\ Fusion.app/Contents/Library/VMware\ OVF\ Tool/ovftool'
alias flushdns='sudo killall -HUP mDNSResponder; sleep 1; dscacheutil -flushcache'
alias cow='/usr/games/fortune | cowsay'
alias grep='grep --color'
alias devenv='cd ${SANDBOX}/svt-dev-tools && source bin/svtsetup'
alias alljar='find . -name \*all.jar'
alias vscode="sh -c \"env LD_LIBRARY_PATH\=\$HOME/lib /usr/share/code/code\" %U"


if [ -f ~/.git_alias ];then
  source ~/.git_alias
fi

source "/home/wwallace/.sdkman/bin/sdkman-init.sh"

source ${HOME}/bin/functions.sh

xvim() {
  for i in $@
  do
    xterm  -e vim $i &
  done
}

xless() {
  for i in $@
  do
    xterm -e less $i &
  done
}

fif() {
  options="-l"
  if [ "X${show_in_file}" = "Xtrue" ];then
    options=""
  fi
  if [ -z $1 ];then
    red "Please provide a directory to start in"
    echo "usage fif <dir> <string>"
    return
  fi
  if [ -z $2 ];then
    red "Please provide a string to look for"
    echo "usage fif <dir> <string>"
    return
  fi
  find -L $1 -type f -exec grep ${options} "$2" {} \;
  show_in_file="false"
}

sif() {
  show_in_file=true
fif ${@} 
}

echo $PATH | grep -q ${MVN_BIN} || export PATH=${MVN_BIN}:${PATH}
echo $PATH | grep -q ${JAVA_HOME}/bin || export PATH=${JAVA_HOME}/bin:${PATH}
echo $PATH | grep -q ${HOME}/bin || export PATH=${HOME}/bin:${PATH}
echo $PATH | grep -q ${GOPATH}/bin || export PATH=${PATH}:${GOPATH}/bin
echo $PATH | grep -q ${GO_BIN} || export PATH=${PATH}:${GO_BIN}

#RVM a ruby version manager
if [ -z ${RVMBIN} ];then
  export RVMBIN=${HOME}/.rvm/bin
  export PATH="$PATH:${RVMBIN}" # Add RVM to PATH for scripting
fi
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" # Load RVM into a shell session *as a function*

spec() {
  if [ $#  -ne 1 ];then
    red 'Please provide a directory argument'
    return
  fi
  if [ ! -d $1 ];then
    red "$1 is not a directory"
    return
  fi
  pushd $1; 
  set -x
  bundle install --path vendor/gems
  bundle exec rake spec_prep
  set +x
  cyan 'bundle exec rspec <path/to/spec_file.rb>'
  popd
}

envs() {
  #OLDPWD=`pwd`
  pushd . > /dev/null
  for i in `find $SANDBOX -maxdepth 3 -type d -name .git`
  do
    path=`echo ${i} | sed 's/\/\.git//'`
    if [ -d ${path}/.git ];then
      echo -n "$path: "
      cd ${path} && git br | grep \*
    fi
  done
  popd > /dev/null
  #cd $OLDPWD
}

buildDiscriptor() {
  grep 'artifactoryBuildMetadata' ~/.gradle/gradle.properties  | grep -v \# | awk -F= '{print $2}'
}

cow
